Supervised Learning for Dynamical System Learning

Ahmed Hefny âˆ—

Carnegie Mellon University

Pittsburgh, PA 15213

ahefny@cs.cmu.edu

Carlton Downey â€ 

Carnegie Mellon University

Pittsburgh, PA 15213

cmdowney@cs.cmu.edu

Geoffrey J. Gordon â€¡

ggordon@cs.cmu.edu

Carnegie Mellon University

Pittsburgh, PA 15213

Abstract

Recently there has been substantial interest in spectral methods for learning dy-
namical systems. These methods are popular since they often offer a good tradeoff
between computational and statistical efï¬ciency. Unfortunately, they can be dif-
ï¬cult to use and extend in practice: e.g., they can make it difï¬cult to incorporate
prior information such as sparsity or structure. To address this problem, we present
a new view of dynamical system learning: we show how to learn dynamical sys-
tems by solving a sequence of ordinary supervised learning problems, thereby
allowing users to incorporate prior knowledge via standard techniques such as
L1 regularization. Many existing spectral methods are special cases of this new
framework, using linear regression as the supervised learner. We demonstrate the
effectiveness of our framework by showing examples where nonlinear regression
or lasso let us learn better state representations than plain linear regression does;
the correctness of these instances follows directly from our general analysis.

1

Introduction

Likelihood-based approaches to learning dynamical systems, such as EM [1] and MCMC [2], can
be slow and suffer from local optima. This difï¬culty has resulted in the development of so-called
â€œspectral algorithmsâ€ [3], which rely on factorization of a matrix of observable moments; these
algorithms are often fast, simple, and globally optimal.
Despite these advantages, spectral algorithms fall short in one important aspect compared to EM and
MCMC: the latter two methods are meta-algorithms or frameworks that offer a clear template for
developing new instances incorporating various forms of prior knowledge. For spectral algorithms,
by contrast, there is no clear template to go from a set of probabilistic assumptions to an algorithm.
In fact, researchers often relax model assumptions to make the algorithm design process easier,
potentially discarding valuable information in the process.
To address this problem, we propose a new framework for dynamical system learning, using the
idea of instrumental-variable regression [4, 5] to transform dynamical system learning to a sequence
of ordinary supervised learning problems. This transformation allows us to apply the rich literature
on supervised learning to incorporate many types of prior knowledge. Our new methods subsume a
variety of existing spectral algorithms as special cases.
The remainder of this paper is organized as follows: ï¬rst we formulate the new learning framework
(Sec. 2). We then provide theoretical guarantees for the proposed methods (Sec. 4). Finally, we give
âˆ—This material is based upon work funded and supported by the Department of Defense under Contract No.
FA8721-05-C-0003 with Carnegie Mellon University for the operation of the Software Engineering Institute, a
federally funded research and development center.

â€ Supported by a grant from the PNC Center for Financial Services Innovation
â€¡Supported by NIH grant R01 MH 064537 and ONR contract N000141512365.

1

Figure 1: A latent-state dynamical system.
Observation ot is determined by latent state
st and noise t.

Figure 2: Learning and applying a dynami-
cal system with instrumental regression. The
predictions from S1 provide training data to
S2. At test time, we ï¬lter or predict using the
weights from S2.

two examples of how our techniques let us rapidly design new and useful dynamical system learning
methods by encoding modeling assumptions (Sec. 5).

2 A framework for spectral algorithms

A dynamical system is a stochastic process (i.e., a distribution over sequences of observations) such
that, at any time, the distribution of future observations is fully determined by a vector st called the
latent state. The process is speciï¬ed by three distributions: the initial state distribution P (s1), the
state transition distribution P (st+1 | st), and the observation distribution P (ot | st). For later use,
we write the observation ot as a function of the state st and random noise t, as shown in Figure 1.
Given a dynamical system, one of the fundamental tasks is to perform inference, where we predict
future observations given a history of observations. Typically this is accomplished by maintaining
a distribution or belief over states bt|tâˆ’1 = P (st | o1:tâˆ’1) where o1:tâˆ’1 denotes the ï¬rst t âˆ’ 1
observations. bt|tâˆ’1 represents both our knowledge and our uncertainty about the true state of the
system. Two core inference tasks are ï¬ltering and prediction.1 In ï¬ltering, given the current belief
bt = bt|tâˆ’1 and a new observation ot, we calculate an updated belief bt+1 = bt+1|t that incorporates
ot. In prediction, we project our belief into the future: given a belief bt|tâˆ’1 we estimate bt+k|tâˆ’1 =
P (st+k | o1:tâˆ’1) for some k > 0 (without incorporating any intervening observations).
The typical approach for learning a dynamical system is to explicitly learn the initial, transition, and
observation distributions by maximum likelihood. Spectral algorithms offer an alternate approach
to learning: they instead use the method of moments to set up a system of equations that can be
solved in closed form to recover estimates of the desired parameters. In this process, they typically
factorize a matrix or tensor of observed momentsâ€”hence the name â€œspectral.â€
Spectral algorithms often (but not always [6]) avoid explicitly estimating the latent state or the initial,
transition, or observation distributions; instead they recover observable operators that can be used
to perform ï¬ltering and prediction directly. To do so, they use an observable representation: instead
of maintaining a belief bt over states st, they maintain the expected value of a sufï¬cient statistic of
future observations. Such a representation is often called a (transformed) predictive state [7].
In more detail, we deï¬ne qt = qt|tâˆ’1 = E[Ïˆt | o1:tâˆ’1], where Ïˆt = Ïˆ(ot:t+kâˆ’1) is a vector of future
features. The features are chosen such that qt determines the distribution of future observations

1There are other forms of inference in addition to ï¬ltering and prediction, such as smoothing and likelihood

evaluation, but they are outside the scope of this paper.

2

ð‘œð‘¡âˆ’1 ð‘œð‘¡ ð‘œð‘¡+ð‘˜âˆ’1 ð‘œð‘¡+ð‘˜ history â„Žð‘¡ future ðœ“ð‘¡/ð‘žð‘¡ shifted future ðœ“ð‘¡+1 extended future ðœ‰ð‘¡/ð‘ð‘¡ S1A regression ïƒ ð¸[ð‘žð‘¡|â„Žð‘¡] S1B regression ïƒ  ð¸[ð‘ð‘¡|â„Žð‘¡] S2 regression Condition on ð‘œð‘¡ (filter) ïƒ  ð‘žð‘¡+1 Marginalize ð‘œð‘¡ (predict) ïƒ  ð‘žð‘¡+1|ð‘¡âˆ’1  P (ot:t+kâˆ’1 | o1:tâˆ’1).2 Filtering then becomes the process of mapping a predictive state qt to qt+1
conditioned on ot, while prediction maps a predictive state qt = qt|tâˆ’1 to qt+k|tâˆ’1 = E[Ïˆt+k |
o1:tâˆ’1] without intervening observations.
A typical way to derive a spectral method is to select a set of moments involving Ïˆt, work out the
expected values of these moments in terms of the observable operators, then invert this relationship
to get an equation for the observable operators in terms of the moments. We can then plug in an
empirical estimate of the moments to compute estimates of the observable operators.
While effective, this approach can be statistically inefï¬cient (the goal of being able to solve for the
observable operators is in conï¬‚ict with the goal of maximizing statistical efï¬ciency) and can make
it difï¬cult to incorporate prior information (each new source of information leads to new moments
and a different and possibly harder set of equations to solve). To address these problems, we show
that we can instead learn the observable operators by solving three supervised learning problems.
The main idea is that, just as we can represent a belief about a latent state st as the conditional
expectation of a vector of observable statistics, we can also represent any other distributions needed
for prediction and ï¬ltering via their own vectors of observable statistics. Given such a representation,
we can learn to ï¬lter and predict by learning how to map these vectors to one another.
In particular, the key intermediate quantity for ï¬ltering is the â€œextended and marginalizedâ€ belief
P (ot, st+1 | o1:tâˆ’1)â€”or equivalently P (ot:t+k | o1:tâˆ’1). We represent this distribution via a vector
Î¾t = Î¾(ot:t+k) of features of the extended future. The features are chosen such that the extended
state pt = E[Î¾t | o1:tâˆ’1] determines P (ot:t+k | o1:tâˆ’1). Given P (ot:t+k | o1:tâˆ’1), ï¬ltering and
prediction reduce respectively to conditioning on and marginalizing over ot.
In many models (including Hidden Markov Models (HMMs) and Kalman ï¬lters), the extended state
pt is linearly related to the predictive state qtâ€”a property we exploit for our framework. That is,

pt = W qt

(1)
for some linear operator W . For example, in a discrete system Ïˆt can be an indicator vector repre-
senting the joint assignment of the next k observations, and Î¾t can be an indicator vector for the next
k + 1 observations. The matrix W is then the conditional probability table P (ot:t+k | ot:t+kâˆ’1).
Our goal, therefore, is to learn this mapping W . NaÂ¨Ä±vely, we might try to use linear regression for
this purpose, substituting samples of Ïˆt and Î¾t in place of qt and pt since we cannot observe qt or
pt directly. Unfortunately, due to the overlap between observation windows, the noise terms on Ïˆt
and Î¾t are correlated. So, naÂ¨Ä±ve linear regression will give a biased estimate of W .
To counteract this bias, we employ instrumental regression [4, 5]. Instrumental regression uses in-
strumental variables that are correlated with the input qt but not with the noise t:t+k. This property
provides a criterion to denoise the inputs and outputs of the original regression problem: we remove
that part of the input/output that is not correlated with the instrumental variables. In our case, since
past observations o1:tâˆ’1 do not overlap with future or extended future windows, they are not cor-
related with the noise t:t+k+1, as can be seen in Figure 1. Therefore, we can use history features
ht = h(o1:tâˆ’1) as instrumental variables.
In more detail, by taking the expectation of (1) given ht, we obtain an instrument-based moment
condition: for all t,

E[pt | ht] = E[W qt | ht]

E[E[Î¾t | o1:tâˆ’1] | ht] = W E[E[Ïˆt | o1:tâˆ’1] | ht]

E[Î¾t | ht] = W E[Ïˆt | ht]

(2)
Assuming that there are enough independent dimensions in ht that are correlated with qt, we main-
tain the rank of the moment condition when moving from (1) to (2), and we can recover W by least
squares regression if we can compute E[Ïˆt | ht] and E[Î¾t | ht] for sufï¬ciently many examples t.
Fortunately, conditional expectations such as E[Ïˆt | ht] are exactly what supervised learning algo-
rithms are designed to compute. So, we arrive at our learning framework: we ï¬rst use supervised

2For convenience we assume that the system is k-observable: that is, the distribution of all future obser-
vations is determined by the distribution of the next k observations. (Note: not by the next k observations
themselves.) At the cost of additional notation, this restriction could easily be lifted.

3

Model/Algorithm

Spectral Algorithm
for HMM [3]

SSID for Kalman
ï¬lters (time depen-
dent gain)

SSID for
Kalman
(constant gain)

stable
ï¬lters

future features Ïˆt
U(cid:62)eot where eot is an indicator vec-
tor and U spans the range of qt (typi-
cally the top m left singular vectors of
the joint probability table P (ot+1, ot))
xt and xt âŠ— xt, where xt =
U(cid:62)ot:t+kâˆ’1 for a matrix U that spans
the range of qt (typically the top m left
singular vectors of the covariance matrix
Cov(ot:t+kâˆ’1, otâˆ’k:tâˆ’1))
U(cid:62)ot:t+kâˆ’1 (U obtained as above)

extended future features
Î¾t
U(cid:62)eot+1 âŠ— eot

yt and yt âŠ— yt, where
yt is formed by stacking
U(cid:62)ot+1:t+k and ot.

ot and U(cid:62)ot+1:t+k

Uncontrolled HSE-
PSR [9]

Evaluation functional ks(ot:t+kâˆ’1, .)
for a characteristic kernel ks

ko(ot, .) âŠ— ko(ot, .)
and Ïˆt+1 âŠ— ko(ot, .)

ffilter

Estimate a state normalizer from S1A
output states.

speciï¬es a Gaussian distribution
pt
where conditioning on ot is straightfor-
ward.

steady-state

Estimate
covariance by
solving Riccati equation [8].
pt to-
gether with the steady-state covariance
specify a Gaussian distribution where
conditioning on ot is straightforward.
Kernel Bayes rule [10].

Table 1: Examples of existing spectral algorithms reformulated as two-stage instrument regression
with linear S1 regression. Here ot1:t2 is a vector formed by stacking observations ot1 through ot2 and
âŠ— denotes the outer product. Details and derivations can be found in the supplementary material.

learning to estimate E[Ïˆt | ht] and E[Î¾t | ht], effectively denoising the training examples, and then
use these estimates to compute W by ï¬nding the least squares solution to (2).
In summary, learning and inference of a dynamical system through instrumental regression can be
described as follows:

â€¢ Model Speciï¬cation: Pick features of history ht = h(o1:tâˆ’1), future Ïˆt = Ïˆ(ot:t+kâˆ’1)
and extended future Î¾t = Î¾(ot:t+k). Ïˆt must be a sufï¬cient statistic for P(ot:t+kâˆ’1 |
o1:tâˆ’1). Î¾t must satisfy

â€“ E[Ïˆt+1 | o1:tâˆ’1] = fpredict(E[Î¾t | o1:tâˆ’1]) for a known function fpredict.
â€“ E[Ïˆt+1 | o1:t] = fï¬lter(E[Î¾t | o1:tâˆ’1], ot) for a known function fï¬lter.

ht]. The training data for this model are (ht, Î¾t) across time steps t.

Â¯Ïˆt = E[Ïˆt | ht]. The training data for this model are (ht, Ïˆt) across time steps t.3

â€¢ S1A (Stage 1A) Regression: Learn a (possibly non-linear) regression model to estimate
â€¢ S1B Regression: Learn a (possibly non-linear) regression model to estimate Â¯Î¾t = E[Î¾t |
â€¢ S2 Regression: Use the feature expectations estimated in S1A and S1B to train a model
to predict Â¯Î¾t = W Â¯Ïˆt, where W is a linear operator. The training data for this model are
estimates of ( Â¯Ïˆt, Â¯Î¾t) obtained from S1A and S1B across time steps t.
â€¢ Initial State Estimation: Estimate an initial state q1 = E[Ïˆ1] by averaging Ïˆ1 across
several example realizations of our time series.4
â€¢ Inference: Starting from the initial state q1, we can maintain the predictive state qt =
E[Ïˆt | o1:tâˆ’1] through ï¬ltering: given qt we compute pt = E[Î¾t | o1:tâˆ’1] = W qt. Then,
given the observation ot, we can compute qt+1 = fï¬lter(pt, ot). Or, in the absence of ot,
we can predict the next state qt+1|tâˆ’1 = fpredict(pt). Finally, by deï¬nition, the predictive
state qt is sufï¬cient to compute P(ot:t+kâˆ’1 | o1:tâˆ’1).5

The process of learning and inference is depicted in Figure 2. Modeling assumptions are reï¬‚ected
in the choice of the statistics Ïˆ, Î¾ and h as well as the regression models in stages S1A and S1B.
Table 1 demonstrates that we can recover existing spectral algorithms for dynamical system learning
using linear S1 regression. In addition to providing a unifying view of some successful learning
algorithms, the new framework also paves the way for extending these algorithms in a theoretically
justiï¬ed manner, as we demonstrate in the experiments below.

3Our bounds assume that the training time steps t are sufï¬ciently spaced for the underlying process to mix,

but in practice, the error will only get smaller if we consider all time steps t.

4Assuming ergodicity, we can set the initial state to be the empirical average vector of future features in a

(cid:80)T

single long sequence, 1
T

t=1 Ïˆt.

5It might seem reasonable to learn qt+1 = fcombined(qt, ot) directly, thereby avoiding the need to separately

estimate pt and condition on ot. Unfortunately, fcombined is nonlinear for common models such as HMMs.

4

3 Related Work

This work extends predictive state learning algorithms for dynamical systems, which include spec-
tral algorithms for Kalman ï¬lters [11], Hidden Markov Models [3, 12], Predictive State Represen-
tations (PSRs) [13, 14] and Weighted Automata [15]. It also extends kernel variants such as [9],
which builds on [16]. All of the above work effectively uses linear regression or linear ridge regres-
sion (although not always in an obvious way).
One common aspect of predictive state learning algorithms is that they exploit the covariance struc-
ture between future and past observation sequences to obtain an unbiased observable state represen-
tation. Boots and Gordon [17] note the connection between this covariance and (linear) instrumental
regression in the context of the HSE-HMM. We use this connection to build a general framework for
dynamical system learning where the state space can be identiï¬ed using arbitrary (possibly nonlin-
ear) supervised learning methods. This generalization lets us incorporate prior knowledge to learn
compact or regularized models; our experiments demonstrate that this ï¬‚exibility lets us take better
advantage of limited data.
Reducing the problem of learning dynamical systems with latent state to supervised learning bears
similarity to Langford et al.â€™s sufï¬cient posterior representation (SPR) [18], which encodes the state
by the sufï¬cient statistics of the conditional distribution of the next observation and represents sys-
tem dynamics by three vector-valued functions that are estimated using supervised learning ap-
proaches. While SPR allows all of these functions to be non-linear, it involves a rather complicated
training procedure involving multiple iterations of model reï¬nement and model averaging, whereas
our framework only requires solving three regression problems in sequence. In addition, the theo-
retical analysis of [18] only establishes the consistency of SPR learning assuming that all regression
steps are solved perfectly. Our work, on the other hand, establishes convergence rates based on the
performance of S1 regression.

4 Theoretical Analysis

In this section we present error bounds for two-stage instrumental regression. These bounds hold
regardless of the particular S1 regression method used, assuming that the S1 predictions converge to
the true conditional expectations. The bounds imply that our overall method is consistent.
Let (xt, yt, zt) âˆˆ (X ,Y,Z) be i.i.d. triplets of input, output, and instrumental variables. (Lack of
independence will result in slower convergence in proportion to the mixing time of our process.) Let
Â¯xt and Â¯yt denote E[xt | zt] and E[yt | zt]. And, let Ë†xt and Ë†yt denote Ë†E[xt | zt] and Ë†E[yt | zt] as
estimated by the S1A and S1B regression steps. Here Â¯xt, Ë†xt âˆˆ X and Â¯yt, Ë†yt âˆˆ Y.
We want to analyze the convergence of the output of S2 regressionâ€”that is, of the weights W given
by ridge regression between S1A outputs and S1B outputs:

Here âŠ— denotes tensor (outer) product, and Î» > 0 is a regularization parameter that ensures the
invertibility of the estimated covariance.
Before we state our main theorem we need to quantify the quality of S1 regression in a way that is
independent of the S1 functional form. To do so, we place a bound on the S1 error, and assume that
this bound converges to zero: given the deï¬nition below, for each ï¬xed Î´, limNâ†’âˆž Î·Î´,N = 0.
Deï¬nition 1 (S1 Regression Bound). For any Î´ > 0 and N âˆˆ N+, the S1 regression bound Î·Î´,N > 0
is a number such that, with probability at least (1 âˆ’ Î´/2), for all 1 â‰¤ t â‰¤ N:

(cid:107)Ë†xt âˆ’ Â¯xt(cid:107)X < Î·Î´,N
(cid:107)Ë†yt âˆ’ Â¯yt(cid:107)Y < Î·Î´,N

In many applications, X , Y and Z will be ï¬nite dimensional real vector spaces: Rdx, Rdy and
Rdz. However, for generality we state our results in terms of arbitrary reproducing kernel Hilbert
spaces. In this case S2 uses kernel ridge regression, leading to methods such as HSE-PSRs. For

5

(cid:32) T(cid:88)

t=1

(cid:33)(cid:32) T(cid:88)

t=1

(cid:33)âˆ’1

Ë†WÎ» =

Ë†yt âŠ— Ë†xt

Ë†xt âŠ— Ë†xt + Î»IX

(3)

this purpose, let Î£Â¯xÂ¯x and Î£Â¯y Â¯y denote the (uncentered) covariance operators of Â¯x and Â¯y respectively:
Î£Â¯xÂ¯x = E[Â¯x âŠ— Â¯x], Î£Â¯y Â¯y = E[Â¯y âŠ— Â¯y]. And, let R(Î£Â¯xÂ¯x) denote the closure of the range of Î£Â¯xÂ¯x.
With the above assumptions, Theorem 2 gives a generic error bound on S2 regression in terms of
S1 regression. If X and Y are ï¬nite dimensional and Î£Â¯xÂ¯x has full rank, then using ordinary least
squares (i.e., setting Î» = 0) will give the same bound, but with Î» in the ï¬rst two terms replaced by
the minimum eigenvalue of Î£Â¯xÂ¯x, and the last term dropped.
Theorem 2. Assume that (cid:107)Â¯x(cid:107)X ,(cid:107)Â¯x(cid:107)Y < c < âˆž almost surely. Assume W is a Hilbert-Schmidt
operator, and let Ë†WÎ» be as deï¬ned in (3). Then, with probability at least 1 âˆ’ Î´, for each xtest âˆˆ
R(Î£Â¯xÂ¯x) s.t. (cid:107)xtest(cid:107)X â‰¤ 1, the error (cid:107) Ë†WÎ»xtest âˆ’ W xtest(cid:107)Y is bounded by

ï£«ï£¬ï£¬ï£­Î·Î´,N

ï£«ï£¬ï£¬ï£­ 1

Î»

O

(cid:124)

(cid:114)
(cid:123)(cid:122)

1 +

+

(cid:113) log(1/Î´)

N

Î» 3

2

ï£¶ï£·ï£·ï£¸
ï£¶ï£·ï£·ï£¸
(cid:125)

error in S1 regression

(cid:18) log(1/Î´)âˆš
(cid:18) 1
(cid:123)(cid:122)

N

Î»

+ O

(cid:124)

(cid:19)(cid:19)
(cid:125)

+

+

1
Î» 3

2

(cid:16)âˆš
(cid:17)
(cid:124) (cid:123)(cid:122) (cid:125)

O

Î»

error from ï¬nite samples

error from regularization

We defer the proof to the supplementary material. The supplementary material also provides explicit
ï¬nite-sample bounds (including expressions for the constants hidden by O-notation), as well as
concrete examples of S1 regression bounds Î·Î´,N for practical regression models.
Theorem 2 assumes that xtest is in R(Î£Â¯xÂ¯x). For dynamical systems, all valid states satisfy this
property. However, with ï¬nite data, estimation errors may cause the estimated state Ë†qt (i.e., xtest) to
have a non-zero component in RâŠ¥(Î£Â¯xÂ¯x). Lemma 3 bounds the effect of such errors: it states that, in
a stable system, this component gets smaller as S1 regression performs better. The main limitation
of Lemma 3 is the assumption that fï¬lter is L-Lipchitz, which essentially means that the modelâ€™s
estimated probability for ot is bounded below. There is no way to guarantee this property in practice;
so, Lemma 3 provides suggestive evidence rather than a guarantee that our learned dynamical system
will predict well.
Lemma 3. For observations o1:T , let Ë†qt be the estimated state given o1:tâˆ’1. Let Ëœqt be the projection
of Ë†qt onto R(Î£Â¯xÂ¯x). Assume fï¬lter is L-Lipchitz on pt when evaluated at ot, and fï¬lter(pt, ot) âˆˆ
R(Î£Â¯xÂ¯x) for any pt âˆˆ R(Î£Â¯y Â¯y). Given the assumptions of theorem 2 and assuming that (cid:107)Ë†qt(cid:107)X â‰¤ R
for all 1 â‰¤ t â‰¤ T , the following holds for all 1 â‰¤ t â‰¤ T with probability at least 1 âˆ’ Î´/2.

(cid:107)t(cid:107)X = (cid:107)Ë†qt âˆ’ Ëœqt(cid:107)X = O

(cid:19)

(cid:18) Î·Î´,Nâˆš

Î»

Since Ë†WÎ» is bounded, the prediction error due to t diminishes at the same rate as (cid:107)t(cid:107)X .

5 Experiments and Results

We now demonstrate examples of tweaking the S1 regression to gain advantage. In the ï¬rst experi-
ment we show that nonlinear regression can be used to reduce the number of parameters needed in
S1, thereby improving statistical performance for learning an HMM. In the second experiment we
show that we can encode prior knowledge as regularization.

5.1 Learning A Knowledge Tracing Model

In this experiment we attempt to model and predict the performance of students learning from an
interactive computer-based tutor. We use the Bayesian knowledge tracing (BKT) model [19], which
is essentially a 2-state HMM: the state st represents whether a student has learned a knowledge
component (KC), and the observation ot represents the success/failure of solving the tth question in
a sequence of questions that cover this KC. Figure 3 summarizes the model. The events denoted by
guessing, slipping, learning and forgetting typically have relatively low probabilities.

5.1.1 Data Description

We evaluate the model using the â€œGeometry Area (1996-97)â€ data available from DataShop [20].
This data was generated by students learning introductory geometry, and contains attempts by 59

6

Figure 3: Transitions and observations in BKT. Each node represents a possible value of the state
or observation. Solid arrows represent transitions while dashed arrows represent observations.

students in 12 knowledge components. As is typical for BKT, we consider a studentâ€™s attempt at a
question to be correct iff the student entered the correct answer on the ï¬rst try, without requesting
any hints from the help system. Each training sequence consists of a sequence of ï¬rst attempts for a
student/KC pair. We discard sequences of length less than 5, resulting in a total of 325 sequences.

5.1.2 Models and Evaluation

Under the (reasonable) assumption that the two states have distinct observation probabilities, this
model is 1-observable. Hence we deï¬ne the predictive state to be the expected next observation,
which results in the following statistics: Ïˆt = ot and Î¾t = ot âŠ—k ot+1, where ot is represented by
a 2 dimensional indicator vector and âŠ—k denotes the Kronecker product. Given these statistics, the
extended state pt = E[Î¾t | o1:tâˆ’1] is a joint probability table of ot:t+1.
We compare three models that differ by history features and S1 regression method:
Spec-HMM: This baseline uses ht = otâˆ’1 and linear S1 regression, making it equivalent to the
spectral HMM method of [3], as detailed in the supplementary material.
Feat-HMM: This baseline represents ht by an indicator vector of the joint assignment of the previ-
ous b observations (we set b to 4) and uses linear S1 regression. This is essentially a feature-based
spectral HMM [12]. It thus incorporates more history information compared to Spec-HMM at the
expense of increasing the number of S1 parameters by O(2b).
LR-HMM: This model represents ht by a binary vector of length b encoding the previous b obser-
vations and uses logistic regression as the S1 model. Thus, it uses the same history information as
Feat-HMM but reduces the number of parameters to O(b) at the expense of inductive bias.
We evaluated the above models using 1000 random splits of the 325 sequences into 200 training
and 125 testing. For each testing observation ot we compute the absolute error between actual and
expected value (i.e. |Î´ot=1 âˆ’ Ë†P (ot = 1 | o1:tâˆ’1)|). We report the mean absolute error for each split.
The results are displayed in Figure 4.6 We see that, while incorporating more history information
increases accuracy (Feat-HMM vs. Spec-HMM), being able to incorporate the same information
using a more compact model gives an additional gain in accuracy (LR-HMM vs. Feat-HMM). We
also compared the LR-HMM method to an HMM trained using expectation maximization (EM). We
found that the LR-HMM model is much faster to train than EM while being on par with it in terms
of prediction error.7

5.2 Modeling Independent Subsystems Using Lasso Regression

Spectral algorithms for Kalman ï¬lters typically use the left singular vectors of the covariance be-
tween history and future features as a basis for the state space. However, this basis hides any sparsity
that might be present in our original basis. In this experiment, we show that we can instead use
lasso (without dimensionality reduction) as our S1 regression algorithm to discover sparsity. This is
useful, for example, when the system consists of multiple independent subsystems, each of which
affects a subset of the observation coordinates.

6The differences have similar sign but smaller magnitude if we use RMSE instead of MAE.
7We used MATLABâ€™s built-in logistic regression and EM functions.

7

Correct AnswerSkill KnownSkill KnownSkill UnknownSkill UnknownIncorrectAnswerModel

Training time (relative to Spec-HMM)

1

Spec-HMM Feat-HMM LR-HMM

1.02

2.219

EM

14.323

Figure 4: Experimental results: each graph compares the performance of two models (measured
by mean absolute error) on 1000 train/test splits. The black line is x = y. Points below this line
indicate that model y is better than model x. The table shows training time.

Figure 5: Left singular vectors of (left) true linear predictor from otâˆ’1 to ot (i.e. OT O+), (middle)
covariance matrix between ot and otâˆ’1 and (right) S1 Sparse regression weights. Each column
corresponds to a singular vector (only absolute values are depicted). Singular vectors are ordered by
their mean coordinate, interpreting absolute values as a probability distribution over coordinates.

To test this idea we generate a sequence of 30-dimensional observations from a Kalman ï¬lter. Obser-
vation dimensions 1 through 10 and 11 through 20 are generated from two independent subsystems
of state dimension 5. Dimensions 21-30 are generated from white noise. Each subsystemâ€™s transi-
tion and observation matrices have random Gaussian coordinates, with the transition matrix scaled
to have a maximum eigenvalue of 0.95. States and observations are perturbed by Gaussian noise
with covariance of 0.01I and 1.0I respectively.
We estimate the state space basis using 1000 examples (assuming 1-observability) and compare the
singular vectors of the past to future regression matrix to those obtained from the Lasso regression
matrix. The result is shown in ï¬gure 5. Clearly, using Lasso as stage 1 regression results in a basis
that better matches the structure of the underlying system.

6 Conclusion

In this work we developed a general framework for dynamical system learning using supervised
learning methods. The framework relies on two key principles: ï¬rst, we extend the idea of predictive
state to include extended state as well, allowing us to represent all of inference in terms of predictions
of observable features. Second, we use past features as instruments in an instrumental regression,
denoising state estimates that then serve as training examples to estimate system dynamics.
We have shown that this framework encompasses and provides a uniï¬ed view of some previous
successful dynamical system learning algorithms. We have also demostrated that it can be used
to extend existing algorithms to incorporate nonlinearity and regularizers, resulting in better state
estimates. As future work, we would like to apply this framework to leverage additional techniques
such as manifold embedding and transfer learning in stage 1 regression. We would also like to
extend the framework to controlled processes.

References
[1] Leonard E. Baum, Ted Petrie, George Soules, and Norman Weiss. A maximization technique
occurring in the statistical analysis of probabilistic functions of markov chains. The Annals of

8

Spec-HMM0.260.30.34Feat-HMM0.260.280.30.320.34Spec-HMM0.260.30.34LR-HMM0.260.280.30.320.34Feat-HMM0.260.30.34LR-HMM0.260.280.30.320.34EM0.260.30.34LR-HMM0.260.280.30.320.34Mathematical Statistics, 41(1):pp. 164â€“171, 1970.

[2] W. R. Gilks, S. Richardson, and D. J. Spiegelhalter. Markov Chain Monte Carlo in Practice.

Chapman and Hall, London, 1996 (ISBN: 0-412-05551-1).
This book thoroughly summarizes the uses of MCMC in Bayesian analysis. It is a core book
for Bayesian studies.

[3] Daniel Hsu, Sham M. Kakade, and Tong Zhang. A spectral algorithm for learning hidden

markov models. In COLT, 2009.

[4] Judea Pearl. Causality: Models, Reasoning, and Inference. Cambridge University Press, New

York, NY, USA, 2000.

[5] J.H. Stock and M.W. Watson. Introduction to Econometrics. Addison-Wesley series in eco-

nomics. Addison-Wesley, 2011.

[6] Animashree Anandkumar, Rong Ge, Daniel Hsu, Sham M Kakade, and Matus Telgarsky. Ten-
sor decompositions for learning latent variable models. The Journal of Machine Learning
Research, 15(1):2773â€“2832, 2014.

[7] Matthew Rosencrantz and Geoff Gordon. Learning low dimensional predictive representa-
tions. In ICML â€™04: Twenty-ï¬rst international conference on Machine learning, pages 695â€“
702, 2004.

[8] P. van Overschee and L.R. de Moor. Subspace identiï¬cation for linear systems: theory, imple-

mentation, applications. Kluwer Academic Publishers, 1996.

[9] Byron Boots, Arthur Gretton, and Geoffrey J. Gordon. Hilbert Space Embeddings of Predictive
State Representations. In Proc. 29th Intl. Conf. on Uncertainty in Artiï¬cial Intelligence (UAI),
2013.

[10] Kenji Fukumizu, Le Song, and Arthur Gretton. Kernel bayesâ€™ rule: Bayesian inference with

positive deï¬nite kernels. Journal of Machine Learning Research, 14(1):3753â€“3783, 2013.

[11] Byron Boots. Spectral Approaches to Learning Predictive Representations. PhD thesis,

Carnegie Mellon University, December 2012.

[12] Sajid Siddiqi, Byron Boots, and Geoffrey J. Gordon. Reduced-rank hidden Markov models. In
Proceedings of the Thirteenth International Conference on Artiï¬cial Intelligence and Statistics
(AISTATS-2010), 2010.

[13] Byron Boots, Sajid Siddiqi, and Geoffrey Gordon. Closing the learning planning loop with

predictive state representations. In I. J. Robotic Research, volume 30, pages 954â€“956, 2011.

[14] Byron Boots and Geoffrey Gordon. An online spectral learning algorithm for partially ob-
In Proceedings of the 25th National Conference on

servable nonlinear dynamical systems.
Artiï¬cial Intelligence (AAAI-2011), 2011.

[15] Methods of moments for learning stochastic languages: Uniï¬ed presentation and empirical
comparison. In Proceedings of the 31st International Conference on Machine Learning (ICML-
14), pages 1386â€“1394, 2014.

[16] L. Song, B. Boots, S. M. Siddiqi, G. J. Gordon, and A. J. Smola. Hilbert space embeddings of

hidden Markov models. In Proc. 27th Intl. Conf. on Machine Learning (ICML), 2010.

[17] Byron Boots and Geoffrey Gordon. Two-manifold problems with applications to nonlinear

system identiï¬cation. In Proc. 29th Intl. Conf. on Machine Learning (ICML), 2012.

[18] John Langford, Ruslan Salakhutdinov, and Tong Zhang. Learning nonlinear dynamic mod-
els. In Proceedings of the 26th Annual International Conference on Machine Learning, ICML
2009, Montreal, Quebec, Canada, June 14-18, 2009, pages 593â€“600, 2009.

[19] Albert T. Corbett and John R. Anderson. Knowledge tracing: Modelling the acquisition of

procedural knowledge. User Model. User-Adapt. Interact., 4(4):253â€“278, 1995.

[20] Kenneth R. Koedinger, R. S. J. Baker, K. Cunningham, A. Skogsholm, B. Leber, and John
Stamper. A data repository for the EDM community: The PSLC DataShop. Handbook of
Educational Data Mining, pages 43â€“55, 2010.

[21] Le Song, Jonathan Huang, Alexander J. Smola, and Kenji Fukumizu. Hilbert space embed-
dings of conditional distributions with applications to dynamical systems. In Proceedings of
the 26th Annual International Conference on Machine Learning, ICML 2009, Montreal, Que-
bec, Canada, June 14-18, 2009, pages 961â€“968, 2009.

9

